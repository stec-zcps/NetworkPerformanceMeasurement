[![Build Status](https://app.travis-ci.com/stec-zcps/NetworkPerformanceMeasurment.svg?branch=master)](https://app.travis-ci.com/stec-zcps/NetworkPerformanceMeasurment)
[![FOSSA Status](https://app.fossa.com/api/projects/git%2Bgithub.com%2Fstec-zcps%2FNetworkPerformanceMeasurment.svg?type=shield)](https://app.fossa.com/projects/git%2Bgithub.com%2Fstec-zcps%2FNetworkPerformanceMeasurment?ref=badge_shield)

# Network Performance Measurement

## Concept
The concept of the tool is depicted in the figure below. Packet generation and measurement is handled by external tools
such as [Sockperf](https://github.com/Mellanox/sockperf), [owping](https://github.com/perfsonar/owamp) or 
[Rperf](https://github.com/stec-zcps/rperf). These tools offer only very limited possibilities for the automated 
execution of test scenarios, no extended evaluation or calculation possibilities as well as no database binding for the 
permanent storage of test results. To overcome these limitations this program was developed, which executes the tools 
via command line and processes their results. The results are converted into a common data format and stored in an 
SQL-based database (MariaDB). The unified data format allows the abstraction of results generated by a specific tool. 
In combination with a modular structure, other external tools for network performance measurement can be integrated in 
addition to [Sockperf](https://github.com/Mellanox/sockperf), [owping](https://github.com/perfsonar/owamp) and
[Rperf](https://github.com/stec-zcps/rperf). 

Packet capturing (using [SharpPcap](https://github.com/chmorgan/sharppcap)) allows reference measurements to compare 
software- and hardware-based measurement results. Hardware-based measurements can be done by the 
[Kunbus TAP CURIOUS](https://www.kunbus.de/tap-curious.html) which adds 20 bytes of additional information (e.g. 
timestamp) to each packet. The captured packets can be received using packet capturing on the uplink port. With a the
developed parser the 20 byte additional information of the [Kunbus TAP CURIOUS](https://www.kunbus.de/tap-curious.html)
can be read out and put in relation (using packet index) to the packets of the performed software measurements. If you 
want to use packet capturing during test execution, please read the [Packet Capturing page](docs/PacketCapturing.md).

Depending on the selected tool and the type of latency measurement to be performed (Round Trip Time or One Way Latency),
time synchronization between the test devices is required (e.g. via GPS). As default the round trip time between ping 
and pong will be measured on the client. Some tools like owping or Rperf allow to measure one way latency based on 
systems timestamp. This requires systems clock synchronisation between on client and server system. Find some hints how 
to achieve this on the [Time Synchronisation](docs/TimeSynchronisation.md) page.

The load generation in the network can be done 
e.g. by iperf3. This can optionally be executed on separate devices in the network or on the two test devices.

![Concept](docs/images/overall_concept.svg)

## Setup
Prerequisites:
* Properly setup external tools which should be used for measurement
* Minimum .NET Core 5.0
* MariaDB SQL database
* Grafana
* For packet capturing: sudo privileges
* For precise hardware-based packet capturing: [Kunbus TAP CURIOUS](https://www.kunbus.de/tap-curious.html)

To setup Grafana and MariaDB database the [docker-compose.yml](docker/docker-compose.yml) file in the docker directory 
can be used. You can start the Docker Compose stack using `docker-compose up -d`. After first start Grafana needs to
be configured as described [here](docs/Grafana.md).

## External Tools
This tools uses several external tools for network measurement purposes. Currently, the following tools are supported:
* [Rperf](docs/ExternalTool_Rperf.md)
* [Sockperf](docs/ExternalTool_Sockperf.md)
* [owing](docs/ExternalTool_owping.md)

## Improve Measurement Accuracy
To improve accuracy of the software-based network performance measurement find some hints on the 
[Improve Accuracy page](docs/ImproveAccuracy.md).

## Gateways
In some scenarios (e.g. reference measurements with Kunbus TAP CURIOUS you may want to measure using Gateways on 
client- and server-side. Therefore, see the [Gateway page](docs/Gateway.md).
